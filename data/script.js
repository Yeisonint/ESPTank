let ws=new WebSocket(`ws://${window.location.hostname}/ws`);function receiveStream(){var e=`http://${window.location.hostname}/stream`;fetch(e).then(e=>{let o=e.body.getReader(),t="";!function n(){o.read().then(({done:e,value:o})=>{e||(-1!==(e=(t+=(new TextDecoder).decode(o)).indexOf("\r\n\r\n"))&&(o=new Blob([t.substring(e+4)],{type:"image/jpeg"}),e=URL.createObjectURL(o),document.getElementById("stream").src=e,t=""),n())})}()}).catch(e=>{console.error("Error al recibir el stream:",e)})}receiveStream(),document.addEventListener("keydown",e=>{e=e.key.toLowerCase();["w","a","s","d"].includes(e)&&(ws.send(e),console.log("Tecla enviada:",e))}),ws.onmessage=function(e){console.log("Mensaje recibido del servidor:",e.data)},ws.onerror=function(e){console.error("Error en WebSocket:",e)},ws.onopen=function(){console.log("Conexión WebSocket establecida")},ws.onclose=function(){console.log("Conexión WebSocket cerrada")};